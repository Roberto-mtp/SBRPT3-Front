



<!-- Resumen de ataque -->
<div class="flex flex-column justify-content-center">
  <div class="flex md:flex-wrap m-3 justify-content-between align-items-center p-4 px-8  shadow-2 border-round-md surface-card">
    <div class="flex align-items-center gap-2">
      <i class="pi pi-desktop text-red-500"></i>
      <span class="text-900 font-medium">IP:</span>
      <span class="text-blue-900 font-bold">192.168.2.20</span>
    </div>
    <div class="flex align-items-center gap-2">
      <i class="pi pi-exclamation-triangle text-orange-500"></i>
      <span class="text-900 font-medium">Ataque:</span>
      <span class="text-blue-900 font-bold">PortScan</span>
    </div>
    <div class="flex align-items-center gap-2">
      <i class="pi pi-clock text-blue-500"></i>
      <span class="text-900 font-medium">Hora:</span>
      <span class="font-bold text-blue-900">{{hora}}</span>
    </div>
  </div>
</div>

<div class="flex flex-column align-items-center">
  <app-sequences context="ataques" />
</div>


<div class="flex flex-column surface-card border-round-md shadow-2 m-3 p-3 ">
  <!--Lista de ataques-->
  
    <div class="flex flex column align-items-center justify-content-between m-0">
      <h1 class="text-blue-500">Información de ataque</h1>
      <button pButton label="Volver" class="w-11rem" icon="pi pi-arrow-circle-left " (click)="irADashboar()"></button>
    </div>

    <p-table [columns]="cols" [value]="paginatedDatos" responsiveLayout="scroll" class=" w-full">
      <ng-template pTemplate="header" let-columns>
        <tr>
          <th *ngFor="let col of columns" [pSortableColumn]="col.field" class="text-center text-sm text-blue-500">
            {{ col.header }}
            <ng-container *ngIf="col.field !== 'detalles'">
              <p-sortIcon [field]="col.field"></p-sortIcon>
            </ng-container>
          </th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-rowData let-columns="columns">

        <tr>
          <td *ngFor="let col of columns" [ngClass]="{
                    'text-center': col.field !== 'detalles',
                    'md:text-xs': true,
                    'ls:text-sm': true,
                    'break-words': true
                  }">

            <!-- Para las demás columnas, mostrar los datos -->
            <ng-container *ngIf="col.field !== 'detalles'">
              <span class="whitespace-normal break-words block text-sm">{{ rowData[col.field] }}</span>
            </ng-container>
          </td>
        </tr>

      </ng-template>

    </p-table>



    <div class="flex flex-column">
      <p-paginator [first]="first" [rows]="rows" [totalRecords]="datos.length" [rowsPerPageOptions]="[4, 8, 10]"
        (onPageChange)="onPageChange($event)">
      </p-paginator>
      <div class="flex align-items-center justify-content-end gap-2">
        <!-- <button  pButton label="Volver" class="m-auto w-7rem" icon="pi pi-arrow-circle-left "(click)="irADashboar()"></button> -->
        <button pButton icon="pi pi-download" label="Generar Log" class="flex mt-1 mb-1 w-11rem"
          (click)="generarLog()"></button>
        <button pButton label="Ver detalles" class="mt-1 mb-1 w-11rem" icon="pi pi-eye "
          (click)="detalles(rows)"></button>

      </div>
    </div>


  
</div>

<!-- Modal de detalles -->
<p-dialog [(visible)]="displayModal" [modal]="true" [closable]="false" header="Información detallada"
  [style]="{ width: '50vw' }" [breakpoints]="{ '860px': '80vw' }" [contentStyle]="{ 'padding': '0' }">
  <div class="p-4 surface-card">

    <div class="text-xl text-blue-500 font-bold mb-2 pb-1 text-center">
      Detalles del atacante
    </div>

    <div class="grid  border-round-md border-blue-500 border-1 shadow-2 m-4">

      <div class="col-6 text-right font-semibold">Fecha de detección:</div>
      <div class="col-6 text-left">{{ selectedFile?.fecha_deteccion }}</div>

      <div class="col-6 text-right font-semibold">Id de ataque:</div>
      <div class="col-6 text-left">{{ selectedFile?.id_ataque }}</div>

      <div class="col-6 text-right font-semibold">Tipo:</div>
      <div class="col-6 text-left">{{ selectedFile?.tipo }}</div>

      <div class="col-6 text-right font-semibold">Duración (ms) del evento:</div>
      <div class="col-6 text-left">{{ selectedFile?.duracion }}</div>

      <div class="col-6 text-right font-semibold">Probabilidad:</div>
      <div class="col-6 text-left">{{ selectedFile?.probabilidad }}</div>
    </div>

    <div class="mt-4 text-center">
      <button pButton type="button" label="Aceptar" class="p-button-round p-button-blue-500 w-5"
        (click)="displayModal = false"></button>
    </div>

  </div>
</p-dialog>