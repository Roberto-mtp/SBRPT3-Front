<div
  class="flex flex-column border-round-md border-gray-300 shadow-2 m-2 p-3 w-auto"
>
  <!-- Resumen de ataque -->
  <div
    class="border-gray-300 border-round-md flex flex-column md:flex-row shadow-2 justify-content-between p-4 align-items-center"
  >
    <div class="flex align-items-center">
      <i class="pi pi-desktop text-red-500 mr-2"></i>
      <span class="text-blue-500 font-semibold mr-2">IP:</span>
      <span class="text-blue-700 font-semibold">{{ ipSeleccionada }}</span>
    </div>
    <div class="flex align-items-center">
      <i class="pi pi-clock text-blue-500 mr-2"></i>
      <span class="text-blue-500 font-semibold mr-2">Hora:</span>
      <span class="font-semibold text-blue-700">{{
        hora | date : "dd/MM/yyyy HH:mm:ss"
      }}</span>
    </div>
    <div class="flex flex-column align-items-center">
      <app-sequences
        context="ataques"
        [data]="{
          normalSequence: secuenciaPaquetes,
          noiseSequence: secuenciaTramos,
          notifications: 0
        }"
      />
    </div>
  </div>

  <!--Lista de ataques-->

  <div
    class="flex flex column align-items-center justify-content-between m-0 pt-4"
  >
    <h1 class="m-3 mt-4 text-blue-500">Información de anomalía</h1>
    <p-button
      class="mr-2"
      label="Volver"
      onkeypress="enter"
      pButton
      icon="pi pi-arrow-circle-left"
      (click)="irADashboar()"
    ></p-button>
  </div>

  <p-table
    [columns]="cols"
    [value]="paginatedDatos"
    responsiveLayout="scroll"
    class="mt-4"
    [tableStyle]="{ 'min-width': '60rem' }"
  >
    <ng-template pTemplate="header" let-columns>
      <tr>
        <th
          id="header-{{ col.field }}"
          *ngFor="let col of columns"
          [pSortableColumn]="col.field"
          class="text-center text-sm text-blue-500"
        >
          <div class="flex align-items-center justify-content-center">
            <span>{{ col.header }}</span>
            <ng-container *ngIf="col.field !== 'detalles'">
              <p-sortIcon [field]="col.field"></p-sortIcon>
            </ng-container>
          </div>
        </th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-rowData let-columns="columns">
      <tr>
        <td
          *ngFor="let col of columns"
          [ngClass]="{
            'text-center': col.field !== 'detalles',
            'md:text-xs': true,
            'ls:text-sm': true,
            'break-words': true
          }"
        >
          <!-- Mostrar datos normales -->
          <span *ngIf="col.field !== 'detalles'">
            <ng-container *ngIf="col.field === 'timestamp'; else otherFields">
              {{ rowData[col.field] | date : "dd/MM/yyyy HH:mm:ss" }}
            </ng-container>
            <ng-template #otherFields>
              <ng-container *ngIf="col.field === 'proba'; else normalField">
                {{ rowData[col.field] | number : "1.3-3" }}
              </ng-container>
              <ng-template #normalField>
                {{ rowData[col.field] }}
              </ng-template>
            </ng-template>
          </span>

          <!-- Botón de detalles -->
          <button
            *ngIf="col.field === 'detalles'"
            pButton
            icon="pi pi-eye"
            (click)="Detalles(rowData)"
          ></button>
        </td>
      </tr>
    </ng-template>
  </p-table>

  <div class="flex flex-column">
    <p-paginator
      [first]="first"
      [rows]="rows"
      [totalRecords]="datos.length"
      [rowsPerPageOptions]="[4, 8, 10]"
      (onPageChange)="onPageChange($event)"
    >
    </p-paginator>
    <div class="flex align-items-center justify-content-end gap-2">
      <p-dropdown
        [options]="formatos"
        [(ngModel)]="formatoSeleccionado"
        placeholder="Seleccione formato"
      ></p-dropdown>

      <p-button
        class="mr-2"
        onkeypress="enter"
        pButton
        icon="pi pi-download"
        label="Exportar"
        (click)="exportar()"
      ></p-button>
    </div>
  </div>
</div>

<!-- Modal de detalles -->
<app-attack-details-modal
  [(visible)]="displayModal"
  [attack]="selectedAttack"
></app-attack-details-modal>
